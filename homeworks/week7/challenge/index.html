<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carousel</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
      rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      user-select: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100vw;
      height: 100vh;
    }

    .carousel__window {
      position: relative;
      width: 80vw;
      height: 80vh;
      overflow: hidden;
      border: 1px solid black;
    }

    .carousel__container {
      display: flex;
      width: 100%;
      height: 100%;
      margin: 0 auto;
    }

    .carousel__item {
      position: absolute;
      min-width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 8rem;
      font-family: monospace;
      color: cornsilk;
      transition: all 500ms ease;
    }

    .item1 {
      background: #264653;
    }
    .item2 {
      background: #2a9d8f;
    }
    .item3 {
      background: #e9c46a;
    }

    .left {
      z-index: -10;
      transform: translate(-80vw);
    }
    .middle {
      z-index: 10;
      transform: translate(0vw);
    }
    .right {
      z-index: -10;
      transform: translate(80vw);
    }

    .prev-container,
    .next-container {
      position: absolute;
      z-index: 100;
      top: 0;
      display: flex;
      align-items: center;
      height: 100%;
      padding: 0 1rem;
      cursor: pointer;
    }

    .prev-container {
      left: 0;
    }

    .prev-container:hover {
      box-shadow: inset 100px 0px 30px -100px rgba(0, 0, 0, 0.5);
    }

    .next-container {
      right: 0;
    }

    .next-container:hover {
      box-shadow: inset -100px 0px 30px -100px rgba(0, 0, 0, 0.5);
    }

    .indicator {
      position: absolute;
      width: 50px;
      height: 12px;
      background: cornsilk;
      left: 50%;
      bottom: 40px;
      z-index: 100;
      cursor: pointer;
    }

    .indicator1 {
      transform: translate(-250%);
    }
    .indicator2 {
      transform: translate(-50%);
    }
    .indicator3 {
      transform: translate(150%);
    }
  </style>
</head>
<body>
  <div class="carousel__window">
    <div class="prev-container"><span class="material-icons-outlined prev">chevron_left</span></div>
    <div class="carousel__container">
      <div class="carousel__item item1 middle">1</div>
      <div class="carousel__item item2 right">2</div>
      <div class="carousel__item item3 left">3</div>
    </div>
    <div class="next-container"><span class="material-icons-outlined next">chevron_right</span></div>
    <div class="indicator indicator1"></div>
    <div class="indicator indicator2"></div>
    <div class="indicator indicator3"></div>
  </div>

  <script>
    const carouselWindow = document.querySelector('.carousel__window')
    let isMoving = false

    function indicator(index) {
      isMoving = true
      const firstItem = document.querySelector('.item1')
      const secondItem = document.querySelector('.item2')
      const thirdItem = document.querySelector('.item3')
      for (const item of [firstItem, secondItem, thirdItem]) item.classList.remove('left', 'middle', 'right')

      switch(index) {
        case 'first':
          firstItem.classList.add('middle')
          secondItem.classList.add('right')
          thirdItem.classList.add('left')
          break
        case 'second':
          firstItem.classList.add('left')
          secondItem.classList.add('middle')
          thirdItem.classList.add('right')
          break
        case 'third':
          firstItem.classList.add('right')
          secondItem.classList.add('left')
          thirdItem.classList.add('middle')
          break
        default:
          break
      }

      setTimeout(() => isMoving = false, 500)
    }

    function carousel(direction) {
      // isMoving 設為 true，禁止轉場效果再次被觸發
      isMoving = true

      const rightItem = document.querySelector('.right')
      const middleItem = document.querySelector('.middle')
      const leftItem = document.querySelector('.left')

      // 開始轉場
      switch(direction) {
        case 'slideToLeft':
          rightItem.classList.add('middle')
          middleItem.classList.add('left')
          leftItem.classList.add('right')
          break
        case 'slideToRight':
          rightItem.classList.add('left')
          middleItem.classList.add('right')
          leftItem.classList.add('middle')
          break
        default:
          break
      }

      rightItem.classList.remove('right')
      middleItem.classList.remove('middle')
      leftItem.classList.remove('left')

      // 500ms 後把 isMoving 設回 false，讓轉場效果可以再次被觸發
      setTimeout(() => isMoving = false, 500)
    }

    carouselWindow.addEventListener('click', (e) => {
      // 目前沒有在轉場才執行轉場效果，避免轉場中重複點擊
      if (!isMoving) {
        if (e.target.classList.contains('prev-container') || e.target.classList.contains('prev')) carousel('slideToLeft')
        if (e.target.classList.contains('next-container') || e.target.classList.contains('next')) carousel('slideToRight')
        if (e.target.classList.contains('indicator1')) indicator('first')
        if (e.target.classList.contains('indicator2')) indicator('second')
        if (e.target.classList.contains('indicator3')) indicator('third')
      }
    })
  </script>
</body>
</html>